
import meshtools

var np = 40
var m=LineMesh(fn (t) [cos(t), sin(t), 0], 0...2*Pi:2*Pi/np, closed=true)

var a = AreaEnclosed()

print m
// expect: <Mesh: 40 vertices>

print a.integrand(m)
// expect: [ 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 0.0782172 ]

print a.total(m)
// expect: 3.12869

var grad = a.gradient(m)
var value = Matrix([[ 0.156434, 0.154508, 0.148778, 0.139384, 0.126558, 0.110616, 0.0919499, 0.0710198, 0.0483409, 0.0244717, 0, -0.0244717, -0.0483409, -0.0710198, -0.0919499, -0.110616, -0.126558, -0.139384, -0.148778, -0.154508, -0.156434, -0.154508, -0.148778, -0.139384, -0.126558, -0.110616, -0.0919499, -0.0710198, -0.0483409, -0.0244717, -1.03037e-16, 0.0244717, 0.0483409, 0.0710198, 0.0919499, 0.110616, 0.126558, 0.139384, 0.148778, 0.154508 ],[ -1.21667e-16, 0.0244717, 0.0483409, 0.0710198, 0.0919499, 0.110616, 0.126558, 0.139384, 0.148778, 0.154508, 0.156434, 0.154508, 0.148778, 0.139384, 0.126558, 0.110616, 0.0919499, 0.0710198, 0.0483409, 0.0244717, 1.03037e-16, -0.0244717, -0.0483409, -0.0710198, -0.0919499, -0.110616, -0.126558, -0.139384, -0.148778, -0.154508, -0.156434, -0.154508, -0.148778, -0.139384, -0.126558, -0.110616, -0.0919499, -0.0710198, -0.0483409, -0.0244717 ],[ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ]])
var diff = grad-value
print diff.norm()<5e-6

// expect: true