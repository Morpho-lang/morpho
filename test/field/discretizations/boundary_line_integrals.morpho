
// Gradient of CG1 field

import meshtools 

var mb = MeshBuilder() 
mb.addvertex([0,0])
mb.addvertex([1,0])
mb.addvertex([0,1])
mb.addface([0,1,2])
var m = mb.build()
m.addgrade(1)

fn integrand(x, q) {
    return q 
}

var f = Field(m, fn(x,y) 3 + 4*x - 2*y, functionspace=FunctionSpace("CG1", grade=2))

print abs(LineIntegral(integrand, f, method={ }).total(m) - (7 + 4*sqrt(2))) < 1e-8
// expect: true
