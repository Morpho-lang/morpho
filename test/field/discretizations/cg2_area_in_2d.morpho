// CG2 FunctionSpace in two dimensions

import meshtools 

var mb = MeshBuilder() 
mb.addvertex([0,0])
mb.addvertex([1,0])
mb.addvertex([0,1])
mb.addvertex([1,1])
mb.addface([0,1,2])
mb.addface([1,3,2])
var m = mb.build()
m.addgrade(1)

var l = FunctionSpace("CG2", grade=2)

var f = Field(m, fn (x,y) Matrix([[x,y],[-y, x]]), functionspace=l)

print f.shape() // expect: [ 1, 1, 0 ]

print abs(AreaIntegral(fn (x) sqrt(x[0]*x[1]), method={ "rule" : "cubtri7" }).total(m)-4/9) < 1e-6
// expect: true

print abs(AreaIntegral(fn (x, q) q.trace()^2, f, method={ }).total(m)-4/3) < 1e-6
// expect: true